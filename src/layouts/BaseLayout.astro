---
import '../styles/global.css';

interface Props {
  title: string;
  description: string;
  canonicalURL?: string;
  ogImage?: string;
  type?: 'website' | 'article';
  pubDate?: string;
  tags?: string[];
  structuredData?: object | object[];
}

const {
  title,
  description,
  canonicalURL = Astro.url.href,
  ogImage = '/og-default.png',
  type = 'website',
  pubDate,
  tags = [],
  structuredData,
} = Astro.props;

const SITE_URL = 'https://unamarca.com.ar';
const SITE_NAME = 'UnaMarca';
const ogImageAbsolute = ogImage.startsWith('http') ? ogImage : `${SITE_URL}${ogImage}`;

const navLinks = [
  { href: '/', label: 'Inicio' },
  { href: '/blog', label: 'Blog' },
];

function isActive(href: string) {
  if (href === '/') return Astro.url.pathname === '/';
  return Astro.url.pathname.startsWith(href);
}
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Primary SEO -->
    <title>{title}</title>
    <meta name="description" content={description} />
    <link rel="canonical" href={canonicalURL} />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- Open Graph -->
    <meta property="og:type" content={type} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:site_name" content={SITE_NAME} />
    <meta property="og:image" content={ogImageAbsolute} />
    <meta property="og:locale" content="es_AR" />
    {type === 'article' && pubDate && (
      <meta property="article:published_time" content={pubDate} />
    )}
    {tags.map(tag => (
      <meta property="article:tag" content={tag} />
    ))}

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImageAbsolute} />

    <!-- JSON-LD Structured Data -->
    {structuredData && (
      <script
        type="application/ld+json"
        set:html={JSON.stringify(Array.isArray(structuredData) ? structuredData : [structuredData])}
      />
    )}

    <!-- Sitemap reference -->
    <link rel="sitemap" href="/sitemap-index.xml" />

    <!-- Font Awesome (for WhatsApp icon) -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />

    <!-- Google Fonts: Inter 400–800 -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <header class="site-header">
      <div class="container">
        <a href="/" class="logo" aria-label={`${SITE_NAME} — Inicio`}>
          <span class="logo-icon" aria-hidden="true">
            <!-- Mini shield icon -->
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <path d="M8 1.5L2.5 4v4c0 3.2 2.4 5.8 5.5 6.5 3.1-.7 5.5-3.3 5.5-6.5V4L8 1.5z"
                    fill="rgba(255,255,255,0.9)"/>
            </svg>
          </span>
          <span class="logo-text">{SITE_NAME}</span>
        </a>
        <nav aria-label="Navegación principal">
          {navLinks.map(link => (
            <a href={link.href} class={`nav-link ${isActive(link.href) ? 'active' : ''}`}>
              {link.label}
            </a>
          ))}
          <a href="https://wa.me/5491149712224?text=Hola%2C%20tom%C3%A9%20su%20contacto%20de%20la%20web%20y%20quer%C3%ADa%20consultar%20por%20el%20servicio%20de%20registro%20de%20marcas!" class="nav-cta" target="_blank" rel="noopener noreferrer">Consultar ahora</a>
        </nav>
      </div>
    </header>

    <main id="main-content">
      <slot />
    </main>

    <footer class="site-footer">
      <div class="container">
        <div class="footer-brand">
          <a href="/" class="logo" aria-label={`${SITE_NAME} — Inicio`}>
            <span class="logo-icon" aria-hidden="true">
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M8 1.5L2.5 4v4c0 3.2 2.4 5.8 5.5 6.5 3.1-.7 5.5-3.3 5.5-6.5V4L8 1.5z"
                      fill="rgba(255,255,255,0.7)"/>
              </svg>
            </span>
            <span class="logo-text">{SITE_NAME}</span>
          </a>
          <p>Registro de marcas en Argentina · Trámites ante el INPI</p>
        </div>
        <nav aria-label="Navegación del pie de página">
          {navLinks.map(link => (
            <a href={link.href}>{link.label}</a>
          ))}
        </nav>
      </div>
      <div class="footer-bottom">
        <div class="container">
          <p>&copy; {new Date().getFullYear()} {SITE_NAME}. Todos los derechos reservados.</p>
          <p>Buenos Aires, Argentina</p>
        </div>
      </div>
    </footer>
    <!-- Floating WhatsApp Button -->
    <a
      href="https://wa.me/5491149712224?text=Hola%2C%20tom%C3%A9%20su%20contacto%20de%20la%20web%20y%20quer%C3%ADa%20consultar%20por%20el%20servicio%20de%20registro%20de%20marcas!"
      class="whatsapp-float"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Contactar por WhatsApp"
    >
      <i class="fa fa-whatsapp" aria-hidden="true"></i>
    </a>
  </body>
</html>
